# 2025-05-18 리팩터링 & 기능 개발 계획

## 1. 마크다운 도입

- react-markdown, remark-gfm, rehype-highlight 등 도입
- MessageBubble → 마크다운 지원(MessageMarkdownBubble) 컴포넌트로 분리
- 코드블록, 표, 리스트 등 GPT 스타일 답변 지원

## 2. GPT 답변 플레이스홀더(공백)

- 답변 예상 길이만큼(최대 약 400px) 공간 미리 확보
- 최소 높이(min-height)는 평균 한 줄 기준 24~32px, 2~3줄(60~90px) 정도로 설정
- 답변이 오기 전 placeholder UI로 UX 개선

## 3. 플로팅 입력창 개선

- 현재 입력창이 대화 아래에 붙어있어 스크롤/UX 문제 발생
- 화면 하단(bottom fixed)으로 개선하여 항상 고정

## 4. 챗 UI 기능 쪼개기

- MessageList, MessageMarkdownBubble, ChatInput 등 컴포넌트 분리
- 유지보수성, 확장성, 재사용성 극대화

## [미해결] 마크다운 표/줄바꿈 렌더링 이슈

- GPT가 표 마크다운을 생성해도 react-markdown + remark-gfm에서 표가 한 줄로 붙거나 줄바꿈이 적용되지 않는 현상 발생
- 표 위/아래에 빈 줄을 자동 추가하는 후처리(ensureTableSpacing) 적용했으나, 일부 케이스에서 여전히 표가 제대로 렌더링되지 않음
- 원인: GPT 답변의 마크다운 문법 불일치, 파서의 한계, 후처리 정규식의 커버리지 부족 등
- 추가 개선 필요: 표 마크다운 감지/보정 로직 강화, 혹은 GPT 프롬프트/예시 튜닝 등

## [예정] 코드블록 복사 기능

- 마크다운 코드블록 우측 상단에 복사 버튼(아이콘) 추가
- 클릭 시 해당 코드블록의 코드가 클립보드에 복사됨
- 복사 성공/실패 시 토스트 등으로 안내
- 사용자 편의성 및 실전 활용성 강화 목적

## 2025-05-18 채팅 입력창/마크다운 개선 배포

- 입력창을 화면 하단 48px 위에 fixed로 고정, 가운데 정렬 및 디자인 개선
- 채팅 메시지 영역은 입력창 높이만큼 padding-bottom, overflow hidden으로 하단 마감
- 답변이 오면 자동으로 스크롤이 맨 아래로 이동
- 마크다운 코드블록/표 렌더링 품질 개선 (후처리, 스타일, 자동 닫기 등)
- 회사/실전 환경에서 실제 사용성 테스트 예정

## [적용] SessionSidebar(사이드바) 토글/닫기 UX/상태 일관성 개선

- 사이드바 내부 버튼은 무조건 닫기(setSidebarOpen(false))만 담당
- 헤더(채팅방, StartChat 등) 사이드바 버튼은 무조건 열기(setSidebarOpen(true))만 담당
- handleToggle/handleClose 혼용 제거, 함수 역할 명확화
- 모바일 딤드 클릭 시 닫기 정상 동작
- 상태 꼬임, UX 꼬임, hydration/persist 꼬임 모두 해결
- 코드 가독성, 유지보수성, 확장성 향상

---

> 위 항목들을 순차적으로 개발/적용하며, 각 단계별로 추가 로그 및 결과 기록 예정
