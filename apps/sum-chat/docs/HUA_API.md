# ğŸ“„ HUA_API.md

## ğŸ§­ ê°œìš”

- **ê¸°ëŠ¥ ìš”ì•½**:  
  GPT ê¸°ë°˜ ëŒ€í™”, ì„¸ì…˜ ìƒì„±, ì†Œì…œ ì¸ì¦(êµ¬ê¸€/ì¹´ì¹´ì˜¤) ë“± ì œê³µ
- **ì‚¬ìš© ëª©ì **:  
  ì±—ë´‡/ìƒë‹´/ëŒ€í™”í˜• ì„œë¹„ìŠ¤ ì—°ë™
- **ì—°ë™ íë¦„**:  
  1. ì¸ì¦(ì„ íƒ)
  2. ì„¸ì…˜ ìƒì„± ë° ì œëª© ìë™í™”
  3. ëŒ€í™” API í˜¸ì¶œ ë° ì‘ë‹µ ì²˜ë¦¬

---

## ğŸ”‘ ì¸ì¦

- **API í‚¤ ë°œê¸‰**:  
  ì†Œì…œ ë¡œê·¸ì¸(êµ¬ê¸€/ì¹´ì¹´ì˜¤) ê¸°ë°˜, ë³„ë„ API í‚¤ ì—†ìŒ
- **ê¶Œí•œ ì •ì±…**:  
  JWT ê¸°ë°˜ ì„¸ì…˜, ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ì£¼ìš” ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥
- **ì˜ˆì‹œ ì‘ë‹µ**:  
  [NextAuth ê³µì‹ ë¬¸ì„œ](https://next-auth.js.org/getting-started/introduction) ì°¸ê³ 

---

## ğŸ§± ì—”ë“œí¬ì¸íŠ¸

### ğŸ“Œ ì„¸ì…˜ ì œëª© ìƒì„±

- `POST /api/session-title`
- **íŒŒë¼ë¯¸í„°**:  
  - `message` (string, í•„ìˆ˜): ì„¸ì…˜ì— ì‚¬ìš©í•  ë©”ì‹œì§€
- **ìš”ì²­ ì˜ˆì‹œ**:

  ```json
  { "message": "ì˜¤ëŠ˜ í•˜ë£¨ ì–´ë• ì–´?" }
  ```

- **ì‘ë‹µ ì˜ˆì‹œ**:

  ```json
  { "title": "ì˜¤ëŠ˜ì˜ ëŒ€í™”" }
  ```

---

### ğŸ“Œ GPT ëŒ€í™” (HUA)

- `POST /api/hua`
- **íŒŒë¼ë¯¸í„°**:  
  - `input` (string, í•„ìˆ˜): ìœ ì € ì…ë ¥ ë©”ì‹œì§€  
  - `config` (object, ì˜µì…˜): ëŒ€í™” ì„¤ì •  
  - `session_id` (string, ì˜µì…˜): ì„¸ì…˜ ID
- **ìš”ì²­ ì˜ˆì‹œ**:

  ```json
  {
    "input": "ë‚˜ ì˜¤ëŠ˜ í˜ë“¤ì—ˆì–´",
    "config": { "mode": "listener", "tone": "warm" },
    "session_id": "abc123"
  }
  ```

- **ì‘ë‹µ ì˜ˆì‹œ**:

  ```json
  {
    "response": "ì˜¤ëŠ˜ ì •ë§ ê³ ìƒ ë§ìœ¼ì…¨ì–´ìš”. ë§ˆìŒì„ ë‚˜ëˆ ì¤˜ì„œ ê³ ë§ˆì›Œìš”.",
    "session_id": "abc123",
    "tier": "A",
    "token_usage": {
      "prompt_tokens": 23,
      "completion_tokens": 41,
      "total_tokens": 64
    }
  }
  ```

---

### ğŸ“Œ ì¸ì¦ (NextAuth)

- `POST /api/auth/[...nextauth]`
- **ì„¤ëª…**:  
  êµ¬ê¸€/ì¹´ì¹´ì˜¤ ì†Œì…œ ë¡œê·¸ì¸, JWT ì„¸ì…˜
- **ìš”ì²­/ì‘ë‹µ**:  
  [NextAuth ê³µì‹ ë¬¸ì„œ](https://next-auth.js.org/getting-started/introduction) ì°¸ê³ 

---

## ğŸ› ê°ì‘ êµ¬ì¡° í†µí•©

- **::mode, ::tone, ::tier ì ìš© ë°©ë²•**:  
  `/api/hua`ì˜ `config` íŒŒë¼ë¯¸í„°ì— í¬í•¨  
  ì˜ˆ: `{ "mode": "listener", "tone": "warm", "tier": "4.0" }`
- **slip / ethics íŒŒë¼ë¯¸í„°**:  
  í˜„ì¬ APIì—ëŠ” slip/ethics ì§ì ‘ íŒŒë¼ë¯¸í„° ì—†ìŒ(ì¶”í›„ í™•ì¥ ê°€ëŠ¥)
- **PromptCard ì—°ë™ êµ¬ì¡°**:  
  PromptCardì—ì„œ ì…ë ¥ê°’ì„ ë°›ì•„ `input` ë° `config`ë¡œ ì „ë‹¬

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ê¸°ì¤€

- **ë‹¨ìœ„/í†µí•©/E2E í…ŒìŠ¤íŠ¸ í•­ëª©**:  
  - ì„¸ì…˜ ìƒì„±/ì œëª© ìë™í™” ì •ìƒ ë™ì‘  
  - ëŒ€í™” API ì‘ë‹µ ì •ìƒ/ì—ëŸ¬ ì‹œë‚˜ë¦¬ì˜¤  
  - ì¸ì¦ í”Œë¡œìš°(ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ)
- **ì£¼ìš” ì‘ë‹µ ì‹œë‚˜ë¦¬ì˜¤**:  
  - ì •ìƒ ì‘ë‹µ, íŒŒë¼ë¯¸í„° ëˆ„ë½, ì„œë²„ ì˜¤ë¥˜ ë“±

---

## ğŸ›¡ ë³´ì•ˆ ë° ìœ¤ë¦¬ í•„í„°

- **rate limit**:  
  (ì½”ë“œìƒ ë¯¸êµ¬í˜„, ì¶”í›„ ë¯¸ë“¤ì›¨ì–´ë¡œ í™•ì¥ ê°€ëŠ¥)
- **ìŠ¬ë¦½ ë°œë™ ì¡°ê±´**:  
  ë‚´ë¶€ ì •ì±…ì— ë”°ë¼ ìŠ¬ë¦½ íŠ¸ë¦¬ê±° í‚¤ì›Œë“œ(ì˜ˆ: "ê·¸ë§Œ", "í”¼ê³¤", "ìŠ¬ë¦½", "ì˜ ì" ë“±) ë˜ëŠ” ìµœê·¼ ëŒ€í™” íŒ¨í„´(ë™ì¼ tone ë°˜ë³µ, ê°ì • ë‹¨ì–´ ë°˜ë³µ ë“±)ì´ ê°ì§€ë˜ë©´ ìë™ìœ¼ë¡œ ìŠ¬ë¦½ ìƒíƒœë¡œ ì „í™˜ë©ë‹ˆë‹¤.
- **ìœ¤ë¦¬ ìœ„ë°˜ í‚¤ì›Œë“œ í¬í•¨ ì—¬ë¶€**:  
  "ì‚´ì¸", "ìì‚´", "í…ŒëŸ¬", "í­ë ¥", "í˜ì˜¤", "ì°¨ë³„", "ì„±í­ë ¥", "ì•„ë™í•™ëŒ€", "ë§ˆì•½", "ë¶ˆë²•" ë“± ë‚´ë¶€ ìœ¤ë¦¬ í‚¤ì›Œë“œê°€ ì…ë ¥ì— í¬í•¨ë  ê²½ìš°, ìœ¤ë¦¬ ë³´í˜¸ë¥¼ ìœ„í•´ ìŠ¬ë¦½ ìƒíƒœë¡œ ì „í™˜ë©ë‹ˆë‹¤.
- **ì‘ë‹µ êµ¬ì¡°**:  
  ìŠ¬ë¦½/ìœ¤ë¦¬ ìœ„ë°˜ ê°ì§€ ì‹œ, ë³„ë„ì˜ ì•ˆë‚´ ë©”ì‹œì§€ì™€ í•¨ê»˜ ëŒ€í™”ê°€ ì¼ì‹œ ì¤‘ë‹¨ë˜ë©°, "ê³„ì†í• ê²Œ" ì…ë ¥ ì‹œ ì¬ê°œë©ë‹ˆë‹¤.
- **ìŠ¬ë¦½/ìœ¤ë¦¬ ìœ„ë°˜ UX íë¦„**:  
  ìŠ¬ë¦½ ë˜ëŠ” ìœ¤ë¦¬ ìœ„ë°˜ì´ ê°ì§€ë˜ë©´ ì•ˆë‚´ ë©”ì‹œì§€ì™€ í•¨ê»˜ ëŒ€í™”ê°€ ì¼ì‹œ ì¤‘ë‹¨ë©ë‹ˆë‹¤. ì‚¬ìš©ìëŠ” "ê³„ì†í• ê²Œ" ë“± ì¬ê°œ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ ëŒ€í™”ë¥¼ ì´ì–´ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ìŠ¬ë¦½ ìˆ˜ì‹/ë¡œì§ì€ í˜„ì¬ ë¹„í™œì„±í™”)
- **í™˜ê°(hallucination) ì²´í¬**:  
  ì •ì±…ìƒ 'ì •í™•ì„±', 'no-misinformation' ë“± í™˜ê°/ì‚¬ì‹¤ì„± ê²€ì¦ ê·œì¹™ì´ ì •ì˜ë˜ì–´ ìˆìœ¼ë‚˜, ì‹¤ì œ ì½”ë“œì—ëŠ” í™˜ê° ê°ì§€/ì°¨ë‹¨ ê¸°ëŠ¥ì´ ì•„ì§ êµ¬í˜„ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.

---

## ğŸ“Š ì‚¬ìš©ëŸ‰ ê´€ë¦¬

- **ì‚¬ìš©ëŸ‰ í™•ì¸ API**:  
  (í˜„ì¬ ì—†ìŒ, ì¶”í›„ ë„ì… ê°€ëŠ¥)
- **í† í° ì‚¬ìš©ëŸ‰ ê³„ì‚°/í‘œì‹œ**:  
  ëŒ€í™” ì‹œ í”„ë¡¬í”„íŠ¸/ì‘ë‹µ í† í°ëŸ‰ì„ ê³„ì‚°í•˜ì—¬ UIì— í‘œì‹œí•˜ëŠ” ê¸°ëŠ¥ì´ êµ¬í˜„ë˜ì–´ ìˆìœ¼ë‚˜, í˜„ì¬ëŠ” ë¹„í™œì„±í™” ìƒíƒœì…ë‹ˆë‹¤. ì¶”í›„ ì‚¬ìš©ëŸ‰ ì œí•œ, ê³¼ê¸ˆ, í†µê³„ ë“±ì— í™œìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ì œí•œ ì •ì±… (Tierë³„)**:  
  ìŠ¬ë¦½(ìœ¤ë¦¬ ìœ„ë°˜ í¬í•¨) ë°œìƒ íšŸìˆ˜ ë° ëŒ€í™” ë©”ì‹œì§€ ìˆ˜ì— ë”°ë¼ ì„¸ì…˜ì˜ í‹°ì–´ê°€ ìë™ í‰ê°€ë©ë‹ˆë‹¤. ì˜ˆì‹œ: ìŠ¬ë¦½ 1íšŒ ì´ìƒ ì‹œ B, 2íšŒ C, 3íšŒ D, 10íšŒ ë¯¸ë§Œ ë©”ì‹œì§€ A, ê·¸ ì™¸ S ë“±ê¸‰. (ìì„¸í•œ í‰ê°€ëŠ” ë‚´ë¶€ ì •ì±…ì— ë”°ë¦„)
- **í‹°ì–´ ì •ì±… ë° ìë™ í‰ê°€(ì—˜ë¦¬ë² ì´í„°)**:  
  í‹°ì–´ë³„ ê¶Œí•œ, íŠ¹ì§•, ìŠ¬ë¦½ ì¡°ê±´, ì¶”ì²œ í†¤/ëª¨ë“œ, ì˜ˆì‹œ ë¬¸êµ¬ ë“±ì€ ë‚´ë¶€ YAML(`tiers.yml`)ë¡œ ê´€ë¦¬ë©ë‹ˆë‹¤. ì‹¤ì œ ë“±ê¸‰ í‰ê°€ëŠ” slip(ìŠ¬ë¦½/ìœ¤ë¦¬ ìœ„ë°˜) ë°œìƒ íšŸìˆ˜ì™€ ëˆ„ì  ë©”ì‹œì§€ ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìë™ ì‚°ì •(evaluateTier í•¨ìˆ˜)ë˜ë©°, ê° í‹°ì–´ë³„ë¡œ í™œì„±í™”ë˜ëŠ” ê¸°ëŠ¥ê³¼ ì œí•œì´ ë‹¤ë¦…ë‹ˆë‹¤.
- **ì„¸ì…˜ ê°œìˆ˜ ì œí•œ**:  
  í•œ ì‚¬ìš©ìëŠ” ìµœëŒ€ 10ê°œì˜ ì„¸ì…˜ë§Œ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ˆê³¼ ì‹œ ê¸°ì¡´ ì„¸ì…˜ì„ ì‚­ì œí•´ì•¼ ìƒˆ ì„¸ì…˜ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ğŸ·ï¸ í‹°ì–´ë³„ ê¸°ëŠ¥/ê¶Œí•œ ì°¨ì´ (ìš”ì•½)

| í‹°ì–´ | ì£¼ìš” íŠ¹ì§• | í™œì„± ëª¨ë“ˆ | ì˜ˆì‹œ | ì œí•œ |
|------|-----------|-----------|------|------|
| S    | ìµœìƒìœ„ | ì „ì²´ | "ëª¨ë“  ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥" | ì—†ìŒ |
| A    | 10íšŒ ì´ìƒ ëŒ€í™” | Echo, Tra, Ana, Ora | "í‘œì¤€/ê³ ê¸‰ ì‘ë‹µ" | ì¼ë¶€ ê³ ê¸‰ ì œí•œ |
| B    | ìŠ¬ë¦½ 1íšŒ | Echo, Tra, Ana | "ê¸°ë³¸/í‘œì¤€ ì‘ë‹µ" | ê³ ê¸‰/ì „ë¬¸ ì œí•œ |
| C    | ìŠ¬ë¦½ 2íšŒ | Echo, Tra | "ê¸°ë³¸ ì‘ë‹µ" | í‘œì¤€/ê³ ê¸‰ ì œí•œ |
| D    | ìŠ¬ë¦½ 3íšŒ | ì—†ìŒ | "ì°¨ë‹¨/ì•Œë¦¼" | ëª¨ë“  ê¸°ëŠ¥ ì œí•œ |

---

## ğŸ“¦ SDK & ì˜ˆì œ

- **Node ì˜ˆì œ**

  ```js
  fetch('/api/hua', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ input: 'ì•ˆë…•', config: { mode: 'listener' } })
  }).then(res => res.json()).then(console.log);

  ```

- **Python ì˜ˆì œ**

  ```python
  import requests
  res = requests.post('https://{ë„ë©”ì¸}/api/hua', json={
      'input': 'ì•ˆë…•', 'config': {'mode': 'listener'}
  })
  print(res.json())
  ```

- **ì‚¬ìš© íŒ**:  
  config íŒŒë¼ë¯¸í„°ë¡œ ë‹¤ì–‘í•œ ëŒ€í™” ìŠ¤íƒ€ì¼/í†¤ ì ìš© ê°€ëŠ¥

---

## ğŸ§­ ë¬¸ì„œ ë©”íƒ€

- **ì‘ì„±ì**: Rhythm(GPT)  
- **ìµœì¢… ìˆ˜ì •ì¼**: 2024-06-13  
- **ë¬¸ì„œ ë²„ì „**: 0.1 (ì´ˆì•ˆ)
