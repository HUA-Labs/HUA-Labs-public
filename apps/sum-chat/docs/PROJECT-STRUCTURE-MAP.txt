프로젝트 구조 및 연결도 (2025-05 기준, 최신 리팩터링 반영)

.
├── .gitignore                # 깃 무시 파일
├── package.json              # 프로젝트 의존성 및 스크립트
├── tailwind.config.js        # TailwindCSS 설정
├── next.config.js            # Next.js 설정
├── tsconfig.json             # TypeScript 설정
├── README.md                 # 프로젝트 소개
├── .env                      # 환경변수(MONGODB_URI 등)
├── ...
├── src/                      # 소스 코드 루트
│   ├── app/                  # Next.js 라우팅, 페이지/레이아웃
│   │   ├── page.tsx          # 메인 페이지
│   │   ├── layout.tsx        # 전체 레이아웃
│   │   ├── chat/
│   │   │   └── [id]/page.tsx # 개별 채팅 세션 페이지 (params, 세션 상태, 메시지)
│   │   ├── login/            # 로그인 라우트
│   │   ├── api/
│   │   │   ├── logs/         # 감정 로그/통계 API (MongoDB 연동)
│   │   │   └── ...
│   │   └── ...
│   ├── components/           # UI 컴포넌트
│   │   ├── ChatUI.tsx        # 채팅 UI, 메시지 렌더링
│   │   ├── SessionSidebar.tsx# 세션 목록/사이드바 (토글/닫기 UX 일관성, 상태 꼬임/중복 방지 리팩터링 적용)
│   │   ├── SessionHeader.tsx # 채팅방/StartChat 헤더 (사이드바 열기 버튼, 상태 분리)
│   │   ├── MessageInput.tsx  # 메시지 입력창
│   │   ├── ui/               # 재사용 UI 컴포넌트(버튼 등)
│   │   └── ...
│   ├── stores/               # 상태 관리(zustand 등)
│   │   ├── sessionStore.ts   # 세션 상태 (isSidebarOpen 단일 상태, setSidebarOpen/toggleSidebar 단순화)
│   │   ├── chatStore.ts      # 채팅 상태
│   │   └── ...
│   ├── lib/                  # 공용 라이브러리 코드
│   │   ├── mongodb.ts        # MongoDB 연결(mongoose, dbConnect)
│   │   ├── rhythm-loader.ts  # 리듬 프리셋 로더
│   │   ├── openai.ts         # OpenAI 연동
│   │   └── ...
│   ├── models/               # DB 모델/스키마
│   │   ├── EmotionLog.ts     # 감정 로그 mongoose 모델/스키마
│   │   └── ...
│   ├── utils/                # 유틸리티 함수
│   │   ├── session.ts        # 세션 관련 함수
│   │   ├── slip-checker.ts   # 슬립 체크 로직
│   │   └── ...
│   ├── modules/              # 프리셋/설정 yaml
│   │   ├── tiers.yml         # 티어 프리셋
│   │   ├── tone-filters.yml  # 톤 필터
│   │   └── ...
│   ├── types/                # 타입 정의
│   │   ├── session.ts        # 세션 타입
│   │   └── chat.ts           # 채팅 타입
│   ├── hooks/                # 커스텀 훅
│   │   └── useChatLimit.ts   # 채팅 제한 훅
│   ├── lib/                  # 공용 라이브러리 코드
│   │   ├── rhythm-loader.ts  # 리듬 프리셋 로더
│   │   ├── openai.ts         # OpenAI 연동
│   │   └── ...
│   ├── prompts/              # 프롬프트 관련
│   │   ├── systemPrompt.ts   # 시스템 프롬프트
│   │   └── tonePrompts.ts    # 톤 프롬프트
│   ├── config/               # 환경설정 yaml
│   │   └── emotion-words.yml # 감정 단어
│   └── styles/               # 스타일 파일
├── ...

[주요 연결 관계]
- app/ → components/, stores/, hooks/, utils/, lib/, models/ 등 사용
- components/ → stores/, types/, ui/ 등 사용
- stores/ → zustand 등으로 상태 관리, components/에서 구독/제어
- app/api/logs/ → lib/mongodb.ts(dbConnect), models/EmotionLog.ts 등 DB 연동
- lib/mongodb.ts → mongoose로 MongoDB Atlas/Compass 연결
- models/ → 각종 컬렉션 스키마/모델 정의(EmotionLog 등)
- config/.env → MONGODB_URI 등 환경변수로 연결 정보 관리
- utils/, lib/ → 여러 곳에서 공통 함수로 사용
- modules/, config/ → 프리셋/설정 데이터로 utils/lib에서 로드
- prompts/ → 챗봇 프롬프트로 사용
- [id]/page.tsx 등 라우트에서 params, 타입 안전성, 세션/메시지 상태 관리 강화

※ 최근 리팩터링:
- 사이드바 토글/닫기 UX 일관성, 상태 꼬임/중복 방지
- zustand store 구조 단순화
- 헤더/사이드바/딤드 역할 분리
- MongoDB 연결 구조(lib/mongodb.ts, models/, .env) 명확화
- API 라우트에서 dbConnect, 모델 활용
- params, 세션 상태, 메시지 등 타입 안전성 강화

※ 이 파일은 깃에 커밋되지 않음 (.gitignore 처리) 