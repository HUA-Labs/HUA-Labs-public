# 리팩토링 구현 가이드

## 시작하기 전에

이 문서는 실제 리팩토링 작업을 진행할 때 참고하는 단계별 가이드입니다.

## 작업 순서

### Phase 1: 공통 인프라 구축 (우선순위: 최고)

#### 1.1 타입 시스템 구축

**파일 생성:**
- `src/lib/types/common.ts`
- `src/lib/types/index.ts` (re-export)

**작업 내용:**
1. `Color` 타입 정의
2. `Size` 타입 정의
3. `Variant` 타입 정의 (기본 + 확장)
4. 공통 Props 인터페이스 정의

**체크리스트:**
- [ ] 모든 타입이 `export` 되어 있는지 확인
- [ ] 타입이 다른 파일에서 import 가능한지 확인
- [ ] JSDoc 주석 추가

#### 1.2 색상 시스템 구축

**파일 생성:**
- `src/lib/styles/colors.ts`
- `src/lib/styles/index.ts` (re-export)

**작업 내용:**
1. 색상 팔레트 정의
2. 색상 스타일 생성 함수
3. 다크 모드 지원 유틸리티
4. 메모이제이션 적용

**주의사항:**
- Tailwind CSS 클래스와 일치해야 함
- 다크 모드 클래스는 `dark:` prefix 사용
- 타입 안전성 보장

#### 1.3 Variant 시스템 구축

**파일 생성:**
- `src/lib/styles/variants.ts`

**작업 내용:**
1. Variant 스타일 생성 함수
2. Size 스타일 생성 함수
3. 공통 스타일 조합 함수

### Phase 2: Dashboard 컴포넌트 리팩토링

#### 2.1 StatCard 리팩토링

**작업 순서:**
1. 기존 코드 백업
2. 공통 시스템 import
3. `colorClasses` 제거 및 `useColorStyles` 사용
4. 테스트 실행
5. 문서 업데이트

**체크리스트:**
- [ ] 기존 API 호환성 유지
- [ ] 모든 variant가 올바르게 작동하는지 확인
- [ ] 다크 모드가 올바르게 작동하는지 확인
- [ ] 타입 에러 없음
- [ ] 린터 에러 없음

#### 2.2 QuickActionCard 리팩토링

**StatCard와 유사한 패턴이므로 동일한 방식으로 진행**

#### 2.3 MetricCard 리팩토링

**StatCard를 확장한 컴포넌트이므로 공통 베이스 활용**

#### 2.4 SummaryCard 리팩토링

**독립적이지만 패턴이 유사하므로 공통 시스템 적용**

### Phase 3: 기본 컴포넌트 리팩토링

#### 3.1 Button 리팩토링

**주의사항:**
- Button은 가장 많이 사용되는 컴포넌트
- 기존 API를 최대한 유지
- 점진적 마이그레이션 지원

#### 3.2 Badge 리팩토링

**간단한 구조이므로 빠르게 진행 가능**

#### 3.3 Card 리팩토링

**기본 레이아웃 컴포넌트이므로 신중하게 진행**

## 코드 리뷰 체크리스트

각 컴포넌트 리팩토링 후 확인할 사항:

### 기능적 검증
- [ ] 기존 기능이 모두 작동하는가?
- [ ] 새로운 기능이 올바르게 작동하는가?
- [ ] Edge case가 처리되었는가?

### 코드 품질
- [ ] 중복 코드가 제거되었는가?
- [ ] 타입 안전성이 보장되는가?
- [ ] 에러 핸들링이 적절한가?

### 성능
- [ ] 불필요한 재계산이 없는가?
- [ ] 메모이제이션이 적절히 사용되었는가?
- [ ] 번들 크기가 증가하지 않았는가?

### 문서화
- [ ] JSDoc 주석이 추가되었는가?
- [ ] 사용 예제가 업데이트되었는가?
- [ ] 마이그레이션 가이드가 작성되었는가?

## 테스트 전략

### 단위 테스트
각 유틸리티 함수에 대한 단위 테스트 작성

```typescript
// src/lib/styles/__tests__/colors.test.ts
describe('createColorStyles', () => {
  it('should generate correct styles for blue color', () => {
    // ...
  });
});
```

### 컴포넌트 테스트
각 컴포넌트의 렌더링 및 상호작용 테스트

```typescript
// src/components/dashboard/__tests__/StatCard.test.tsx
describe('StatCard', () => {
  it('should render with correct color', () => {
    // ...
  });
});
```

### 통합 테스트
여러 컴포넌트가 함께 작동하는지 확인

## 롤백 계획

만약 리팩토링 중 문제가 발생하면:

1. **즉시 중단**
2. **Git으로 이전 버전으로 롤백**
3. **문제 분석**
4. **수정 후 재시도**

## 진행 상황 추적

각 Phase 완료 시:

1. TODO 리스트 업데이트
2. CHANGELOG 작성
3. 문서 업데이트
4. 팀에 공유

## 다음 단계

Phase 1 완료 후:
- [ ] 팀 리뷰
- [ ] 피드백 반영
- [ ] Phase 2 시작

Phase 2 완료 후:
- [ ] 통합 테스트
- [ ] 성능 측정
- [ ] 문서 최종 검토

Phase 3 완료 후:
- [ ] 전체 시스템 테스트
- [ ] 마이그레이션 가이드 최종화
- [ ] 릴리스 준비

